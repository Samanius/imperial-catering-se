# MERIDIEN Yacht Catering - Backup System

## Автоматическое архивирование данных

Все изменения, вносимые через админ-панель, автоматически сохраняются в архив для защиты данных.

### Что архивируется

- ✅ Создание ресторанов
- ✅ Обновление информации о ресторанах
- ✅ Удаление ресторанов
- ✅ Все изменения меню и ценников
- ✅ Полная история изменений с временными метками

### Как просмотреть бэкапы

1. Откройте админ-панель
2. Перейдите на вкладку **Backups**
3. Вы увидите список всех изменений с датами и типом операций

### Как экспортировать бэкапы

1. В разделе **Backups** нажмите кнопку **Export JSON**
2. Файл автоматически скачается на ваш компьютер
3. Файл содержит полную историю всех изменений в формате JSON

### Структура бэкапа

Каждая запись содержит:
- **timestamp**: Время изменения (Unix timestamp)
- **date**: Дата и время в читаемом формате (ISO 8601)
- **action**: Тип операции (create/update/delete)
- **entityType**: Тип объекта (restaurant)
- **entityId**: Уникальный ID объекта
- **entityName**: Название ресторана
- **data**: Полные данные объекта после изменения
- **previousData**: Предыдущее состояние (только для update)

### Хранение данных

Все бэкапы хранятся в ключе `admin-backups` в KV-хранилище Spark и доступны только владельцу приложения.

### Восстановление данных

В случае случайного удаления данных:

1. Экспортируйте бэкапы через админ-панель
2. Найдите нужную версию данных в JSON файле
3. Скопируйте данные из поля `data` или `previousData`
4. Создайте новый ресторан через админку и вставьте данные

### Технические детали

Система бэкапов реализована в файле `/src/lib/backup.ts` и автоматически вызывается при всех операциях с данными в AdminPanel.

Ключевые функции:
- `createBackup()` - создание бэкапа
- `getBackups()` - получение всех бэкапов
- `exportBackupsAsJSON()` - экспорт в JSON
- `getLatestBackupForEntity()` - получение последнего бэкапа для объекта

---

**Примечание**: Система бэкапов работает автоматически и не требует настройки. Все изменения сохраняются мгновенно.
